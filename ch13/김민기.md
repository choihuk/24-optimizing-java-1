# IntelliJ 프로파일링

# 개요

IntelliJ 프로파일러를 통해서 jvm 애플리케이션의 프로파일링 확인해보기

# 왜 IntelliJ Profiler 인가?

다른 에이전트나 프로그램을 설치할 필요없이, 개발환경에서 바로 실행하고 확인해 볼 수 있는 접근성이 뛰어나며, 결과를 프로파일링 종료 후 바로 확인이 가능함

물론 운영 환경에선 다른 상용 프로파일러를 사용해야 하지만 프로파일링을 간편히 확인해볼 수 있다는 점에서 토이프로젝트나 개발환경에서 간단한 디버깅용으로 쓰기 좋을거 같다.

## 시작하기

먼저 IntelliJ → View → Tool Windows → Profiler 로 콘솔창에서 조회할 수 있다.

실행은 프로그램 실행하는 run → Profile ‘애플리케이션명’ with IntelliJ Profiler 를 선택해서 실행하게 되면 프로파일링을 시작하며 Stop으로 중지하면 프로파일링을 종료하고 바로 show result로 볼 수 있다.

![스크린샷 2024-03-10 오후 8.47.24.png](../images/스크린샷 2024-03-10 오후 8.47.24.png)

## 현재 프로세스 조회하기

먼저 콘솔창 위치에 있는 Profiler 창이 있다면 Home → Process → CPU and Memory Live Charts 로 현재 실행중인 프로세스의 cpu, memory, threads 상태들을 확인해 볼 수 있다.

![스크린샷 2024-03-10 오후 8.53.12.png](../images/스크린샷 2024-03-10 오후 8.53.12.png)

## Heap Dump

콘솔창 옆에 카메라 모양 아이콘을 보면

- Capture Memory Snapshot,

  ![스크린샷 2024-03-10 오후 9.24.00.png](../images/스크린샷 2024-03-10 오후 9.24.00.png)

- Get Thread Dump

  ![스크린샷 2024-03-10 오후 9.24.18.png](../images/스크린샷 2024-03-10 오후 9.24.18.png)


두가지 정보를 얻을 수 있다.

## 프로파일링 결과보기

프로파일링 결과를 확인하게 되면 애플리케이션명과 프로파일링한 일시가 적힌 탭을 눌러서 확인해 볼 수 있다.

- Flame Graph : 전체적으로 프로파일링된 클래스, 메서드와 메모리 상태, 호출된 스택을 확인해 볼 수 있다.

  ![스크린샷 2024-03-10 오후 8.54.23.png](../images/스크린샷 2024-03-10 오후 8.54.23.png)


- Call Tree : 샘플링된 데이터를 트리 구조로 구성하며 실행 시간, 재귀 호출, 필퍼링된 호출들을 확인해 볼 수 있다.

  ![스크린샷 2024-03-10 오후 9.29.09.png](../images/스크린샷 2024-03-10 오후 9.29.09.png)

- Method List : 프로필 데이터의 모든 분석법을 수집하고 누적 샘플 시간을 기준으로 정렬하며, 호출자의 계층 구조, 호출 수신자, 호출 수신자 리스트를 볼 수 있다.

  ![스크린샷 2024-03-10 오후 9.29.03.png](../images/스크린샷 2024-03-10 오후 9.29.03.png)

- Time line : 개별 스레드의 활동을 모니터링하는 기능으로 시간 경과에 따른 CPU 활동과 메모리 할당을 시각화해서 보여준다. 가장 활동적인 스레드, 동시성 문제 확인, IO 프로파일등을 확인할 수 있다.

  ![스크린샷 2024-03-10 오후 9.28.56.png](../images/스크린샷 2024-03-10 오후 9.28.56.png)

- Events : 애플리케이션, JVM, OS등 프로세스와 연관된 이벤트 처리목록을 조회할 수 있다.


참조

- https://www.jetbrains.com/help/idea/read-the-profiling-report.html#profiler-flame-chart
- https://gomnezip.tistory.com/396